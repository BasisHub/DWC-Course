---
phase: 01-pre-flight
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docusaurus.config.ts
  - CLAUDE.md
autonomous: true

must_haves:
  truths:
    - "The site builds with zero warnings (no deprecation, no future.v4 artifacts)"
    - "React 19 compatibility with Phase 2 plugins is verified and documented"
    - "CLAUDE.md accurately reflects the deployed baseUrl /DWC-Course/"
  artifacts:
    - path: "docusaurus.config.ts"
      provides: "Clean Docusaurus config without future.v4 flag"
      contains: "markdown:"
    - path: "CLAUDE.md"
      provides: "Correct baseUrl documentation"
      contains: "/DWC-Course/"
  key_links:
    - from: "docusaurus.config.ts"
      to: "npm run build"
      via: "Docusaurus build pipeline"
      pattern: "baseUrl.*DWC-Course"
---

<objective>
Clean up Docusaurus configuration by removing the `future.v4` flag, migrating the deprecated `onBrokenMarkdownLinks` setting, and fixing the incorrect baseUrl reference in CLAUDE.md. This covers requirements PRE-01, PRE-02, and PRE-03.

Purpose: Resolve all config-level risks before Phase 2 plugin integration. The v4 flag enables CSS Cascade Layers which has a known production bug (Issue #11567). The baseUrl discrepancy in CLAUDE.md creates confusion for any Claude instance or developer reading project docs.

Output: A clean-building Docusaurus config with no deprecation warnings and accurate project documentation.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-pre-flight/01-CONTEXT.md
@.planning/phases/01-pre-flight/01-RESEARCH.md
@docusaurus.config.ts
@CLAUDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove future.v4 flag and migrate onBrokenMarkdownLinks deprecation</name>
  <files>docusaurus.config.ts</files>
  <action>
  Two changes to docusaurus.config.ts:

  1. Remove the `future` block (lines 10-12):
     ```
     future: {
       v4: true,
     },
     ```
     Delete these 3 lines entirely including the trailing blank line. The config should go directly from `favicon` to `url`.

  2. Migrate the deprecated `onBrokenMarkdownLinks` setting:
     - Remove `onBrokenMarkdownLinks: 'warn',` from its current location (line 23 area, at the root config level)
     - Add a new `markdown` key to the config object (after the `i18n` block, before `presets`):
       ```typescript
       markdown: {
         hooks: {
           onBrokenMarkdownLinks: 'warn',
         },
       },
       ```

  Do NOT add any comments explaining why the flag was removed. The commit message handles that.
  Do NOT change `onBrokenLinks: 'throw'` -- that stays at root level (it is not deprecated).
  </action>
  <verify>
  Run `npm run build` from the project root. Expected:
  - Build succeeds with exit code 0
  - NO `onBrokenMarkdownLinks` deprecation warning in output
  - NO warnings related to future.v4 or cascade layers
  - The only expected output is standard build progress messages

  Then run `npm run typecheck` to confirm no type errors were introduced.
  </verify>
  <done>
  docusaurus.config.ts has no `future` block, `onBrokenMarkdownLinks` lives under `markdown.hooks`, and `npm run build` produces zero warnings.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix CLAUDE.md baseUrl and document React 19 compatibility</name>
  <files>CLAUDE.md</files>
  <action>
  1. Fix the incorrect baseUrl reference on line 49 of CLAUDE.md:
     Change: `Base URL is `/bbj-dwc-tutorial/` (configured for GitHub Pages).`
     To: `Base URL is `/DWC-Course/` (configured for GitHub Pages).`

  2. PRE-02 (React 19 compatibility) requires no code changes. Research confirmed all Phase 2 plugins (Algolia search, Mermaid, ideal-image) are compatible with React 19 at Docusaurus 3.9.2. This finding will be captured in the plan SUMMARY as a documented decision. No file changes needed for PRE-02 itself.

  Do NOT change any other content in CLAUDE.md beyond the baseUrl line.
  </action>
  <verify>
  Read CLAUDE.md and confirm line 49 (or wherever the Deployment section references baseUrl) now says `/DWC-Course/`.
  Run `grep -n 'bbj-dwc-tutorial' CLAUDE.md` and confirm zero matches (the baseUrl reference was the only incorrect one; other references like the project overview may legitimately mention the tutorial name).

  Actually, grep for the specific pattern: `grep -n 'baseUrl\|base.URL\|Base URL' CLAUDE.md` and verify the output shows `/DWC-Course/`.
  </verify>
  <done>
  CLAUDE.md accurately states the baseUrl as `/DWC-Course/`. The React 19 compatibility finding (no downgrade needed, all Phase 2 plugins compatible) is documented in the plan SUMMARY.
  </done>
</task>

</tasks>

<verification>
After both tasks:
1. `npm run build` exits cleanly with zero warnings
2. `npm run typecheck` passes
3. `docusaurus.config.ts` contains no `future:` block
4. `docusaurus.config.ts` contains `markdown: { hooks: { onBrokenMarkdownLinks: 'warn' } }`
5. `CLAUDE.md` references `/DWC-Course/` not `/bbj-dwc-tutorial/` for the base URL
</verification>

<success_criteria>
- PRE-01: `future.v4` flag removed, site builds cleanly
- PRE-02: React 19 compatibility confirmed (documented in SUMMARY, no code change needed)
- PRE-03: CLAUDE.md baseUrl corrected to `/DWC-Course/`
- Bonus: `onBrokenMarkdownLinks` deprecation warning eliminated via migration to `markdown.hooks`
</success_criteria>

<output>
After completion, create `.planning/phases/01-pre-flight/01-01-SUMMARY.md`

The SUMMARY must include a section documenting the PRE-02 finding:
> React 19 (19.2.3) is fully compatible with all Phase 2 target plugins at Docusaurus 3.9.2:
> - @docusaurus/theme-search-algolia (React 19 support since v3.7)
> - @docusaurus/theme-mermaid (React 19 support since v3.7, ELK fix in 3.9.2)
> - @docusaurus/plugin-ideal-image (react-waypoint internalized in PR #11014)
> No React downgrade is needed. Phase 2 can proceed with React 19.
</output>
